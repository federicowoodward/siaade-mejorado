<div class="m-w-custom">
  <div class="py-2">
    <p-button (onClick)="goBack()"> Volver </p-button>
  </div>

  <p-card
    *ngIf="!loading() && data()?.career; else loadingTpl"
    class="career-header"
  >
    <h2>{{ data()!.career!.name }}</h2>
    <p>
      <strong>Preceptor:</strong>
      {{ data()!.preceptor!.name }} {{ data()!.preceptor!.lastName }}
      &nbsp;|&nbsp;
      <strong>Email:</strong> {{ data()!.preceptor!.email }}
    </p>
  </p-card>

  <ng-template #loadingTpl>
    <div class="center">
      <p-progressSpinner ariaLabel="Cargando"></p-progressSpinner>
    </div>
  </ng-template>

  <div *ngIf="error() && !loading()" class="error">{{ error() }}</div>

  <div *ngIf="data()?.academicPeriods?.length">
    <div *ngFor="let period of data()!.academicPeriods" class="period-block">
      <h3 class="year-title">{{ period.academicPeriod.name }}</h3>

      <p-table
        [value]="period.subjects"
        responsiveLayout="scroll"
        styleClass="p-datatable-sm p-datatable-gridlines"
      >
        <ng-template pTemplate="header">
          <tr>
            <th style="width: 4rem">N° de orden</th>
            <th>Asignatura</th>
            <th>Campo de formación</th>
            <th>Forma</th>
            <th>Hs. semanales</th>
            <th>Hs. anuales</th>
            <th>Correlativas</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-s>
          <tr>
            <td>{{ s.careerOrdering.orderNo }}</td>
            <td>{{ s.subjectName }}</td>
            <td>{{ s.metadata.teacherFormation }}</td>
            <td>{{ s.metadata.subjectFormat }}</td>
            <td>{{ s.metadata.weeklyWorkload }}</td>
            <td>{{ s.metadata.annualWorkload }}</td>
            <td>{{ s.metadata.correlative || '-' }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
