<div class="reset-card">
	<h2>Restablecer contraseña</h2>
	<p class="hint" *ngIf="!token">Ingresá desde el enlace de recuperación.</p>

	<form [formGroup]="form" (ngSubmit)="submit()">
				<div class="field" *ngIf="mode === 'change'">
					<label for="pwd_current">Contraseña actual</label>
					<p-password [toggleMask]="true" [feedback]="false" formControlName="current" inputId="pwd_current"
						[inputStyleClass]="'w-full'" styleClass="w-full" placeholder="pass1234" [autocomplete]="'current-password'">
					</p-password>
					<div class="field-error" *ngIf="currentError">{{ currentError }}</div>
				</div>
				<div class="field">
					<label for="pwd_new">Nueva contraseña</label>
					<p-password [toggleMask]="true" [feedback]="false" formControlName="password" inputId="pwd_new"
						[inputStyleClass]="'w-full'" styleClass="w-full" placeholder="Mínimo 8; mayúscula, minúscula y número" [autocomplete]="'new-password'">
					</p-password>
					<ul class="policy-list" *ngIf="passwordValue.length > 0">
						<li [class.ok]="passwordValue.length >= 8">
							<i class="pi icon" [ngClass]="passwordValue.length >= 8 ? 'pi-check-circle' : 'pi-circle'" aria-hidden="true"></i>
							Mínimo 8 caracteres
						</li>
						<li [class.ok]="hasUpper">
							<i class="pi icon" [ngClass]="hasUpper ? 'pi-check-circle' : 'pi-circle'" aria-hidden="true"></i>
							Al menos una mayúscula
						</li>
						<li [class.ok]="hasLower">
							<i class="pi icon" [ngClass]="hasLower ? 'pi-check-circle' : 'pi-circle'" aria-hidden="true"></i>
							Al menos una minúscula
						</li>
						<li [class.ok]="hasDigit">
							<i class="pi icon" [ngClass]="hasDigit ? 'pi-check-circle' : 'pi-circle'" aria-hidden="true"></i>
							Al menos un número
						</li>
					</ul>
				</div>
				<div class="field">
					<label for="pwd_confirm">Confirmar contraseña</label>
					<p-password [toggleMask]="true" [feedback]="false" formControlName="confirm" inputId="pwd_confirm"
						[inputStyleClass]="'w-full'" styleClass="w-full" placeholder="pass1234" [autocomplete]="'new-password'">
					</p-password>
					<div class="mismatch" *ngIf="mismatch">Las contraseñas no coinciden</div>
				</div>

				<p class="server-error" *ngIf="serverError">{{ serverError }}</p>
		<button pButton type="submit" label="Guardar" [disabled]="submitting || !canSubmit"></button>
	</form>
</div>
